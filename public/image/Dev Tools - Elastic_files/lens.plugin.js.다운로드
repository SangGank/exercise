/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */(function(modules){function webpackJsonpCallback(data){var chunkIds=data[0];var moreModules=data[1];var moduleId,chunkId,i=0,resolves=[];for(;i<chunkIds.length;i++){chunkId=chunkIds[i];if(Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]){resolves.push(installedChunks[chunkId][0])}installedChunks[chunkId]=0}for(moduleId in moreModules){if(Object.prototype.hasOwnProperty.call(moreModules,moduleId)){modules[moduleId]=moreModules[moduleId]}}if(parentJsonpFunction)parentJsonpFunction(data);while(resolves.length){resolves.shift()()}}var installedModules={};var installedChunks={2:0};function jsonpScriptSrc(chunkId){return __webpack_require__.p+"lens.chunk."+chunkId+".js"}function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.e=function requireEnsure(chunkId){var promises=[];var installedChunkData=installedChunks[chunkId];if(installedChunkData!==0){if(installedChunkData){promises.push(installedChunkData[2])}else{var promise=new Promise((function(resolve,reject){installedChunkData=installedChunks[chunkId]=[resolve,reject]}));promises.push(installedChunkData[2]=promise);var script=document.createElement("script");var onScriptComplete;script.charset="utf-8";script.timeout=120;if(__webpack_require__.nc){script.setAttribute("nonce",__webpack_require__.nc)}script.src=jsonpScriptSrc(chunkId);var error=new Error;onScriptComplete=function(event){script.onerror=script.onload=null;clearTimeout(timeout);var chunk=installedChunks[chunkId];if(chunk!==0){if(chunk){var errorType=event&&(event.type==="load"?"missing":event.type);var realSrc=event&&event.target&&event.target.src;error.message="Loading chunk "+chunkId+" failed.\n("+errorType+": "+realSrc+")";error.name="ChunkLoadError";error.type=errorType;error.request=realSrc;chunk[1](error)}installedChunks[chunkId]=undefined}};var timeout=setTimeout((function(){onScriptComplete({type:"timeout",target:script})}),12e4);script.onerror=script.onload=onScriptComplete;document.head.appendChild(script)}}return Promise.all(promises)};__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";__webpack_require__.oe=function(err){console.error(err);throw err};var jsonpArray=window["lens_bundle_jsonpfunction"]=window["lens_bundle_jsonpfunction"]||[];var oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback;jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;return __webpack_require__(__webpack_require__.s=20)})([function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DOC_TYPE}));__webpack_require__.d(__webpack_exports__,"b",(function(){return SavedObjectIndexStore}));__webpack_require__.d(__webpack_exports__,"c",(function(){return extractFilterReferences}));__webpack_require__.d(__webpack_exports__,"d",(function(){return injectFilterReferences}));function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DOC_TYPE="lens";var SavedObjectIndexStore=function(){function SavedObjectIndexStore(client){var _this=this;_classCallCheck(this,SavedObjectIndexStore);_defineProperty(this,"client",void 0);_defineProperty(this,"save",function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(vis){var savedObjectId,type,references,rest,attributes,result;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:savedObjectId=vis.savedObjectId,type=vis.type,references=vis.references,rest=_objectWithoutProperties(vis,["savedObjectId","type","references"]);attributes=rest;_context.next=4;return savedObjectId?_this.safeUpdate(savedObjectId,attributes,references):_this.client.create(DOC_TYPE,attributes,{references:references});case 4:result=_context.sent;return _context.abrupt("return",_objectSpread(_objectSpread({},vis),{},{savedObjectId:result.id}));case 6:case"end":return _context.stop()}}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}());this.client=client}_createClass(SavedObjectIndexStore,[{key:"safeUpdate",value:function(){var _safeUpdate=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(savedObjectId,attributes,references){var resetAttributes;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:resetAttributes={};Object.keys(attributes).forEach((function(key){resetAttributes[key]=null}));_context2.next=4;return this.client.bulkUpdate([{type:DOC_TYPE,id:savedObjectId,attributes:resetAttributes,references:references},{type:DOC_TYPE,id:savedObjectId,attributes:attributes,references:references}]);case 4:return _context2.abrupt("return",_context2.sent.savedObjects[1]);case 5:case"end":return _context2.stop()}}}),_callee2,this)})));function safeUpdate(_x2,_x3,_x4){return _safeUpdate.apply(this,arguments)}return safeUpdate}()},{key:"load",value:function(){var _load=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(savedObjectId){var _yield$this$client$ge,type,attributes,references,error;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this.client.get(DOC_TYPE,savedObjectId);case 2:_yield$this$client$ge=_context3.sent;type=_yield$this$client$ge.type;attributes=_yield$this$client$ge.attributes;references=_yield$this$client$ge.references;error=_yield$this$client$ge.error;if(!error){_context3.next=9;break}throw error;case 9:return _context3.abrupt("return",_objectSpread(_objectSpread({},attributes),{},{references:references,savedObjectId:savedObjectId,type:type}));case 10:case"end":return _context3.stop()}}}),_callee3,this)})));function load(_x5){return _load.apply(this,arguments)}return load}()}]);return SavedObjectIndexStore}();function filter_references_objectWithoutProperties(source,excluded){if(source==null)return{};var target=filter_references_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function filter_references_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function filter_references_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function filter_references_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){filter_references_ownKeys(Object(source),true).forEach((function(key){filter_references_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{filter_references_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function filter_references_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function extractFilterReferences(filters){var references=[];var persistableFilters=filters.map((function(filterRow,i){if(!filterRow.meta||!filterRow.meta.index){return filterRow}var refName="filter-index-pattern-".concat(i);references.push({name:refName,type:"index-pattern",id:filterRow.meta.index});return filter_references_objectSpread(filter_references_objectSpread({},filterRow),{},{meta:filter_references_objectSpread(filter_references_objectSpread({},filterRow.meta),{},{indexRefName:refName,index:undefined})})}));return{persistableFilters:persistableFilters,references:references}}function injectFilterReferences(filters,references){return filters.map((function(filterRow){if(!filterRow.meta||!filterRow.meta.indexRefName){return filterRow}var _filterRow$meta=filterRow.meta,indexRefName=_filterRow$meta.indexRefName,metaRest=filter_references_objectWithoutProperties(_filterRow$meta,["indexRefName"]);var reference=references.find((function(ref){return ref.name===indexRefName}));if(!reference){throw new Error("Could not find reference for ".concat(indexRefName))}return filter_references_objectSpread(filter_references_objectSpread({},filterRow),{},{meta:filter_references_objectSpread(filter_references_objectSpread({},metaRest),{},{index:reference.id})})}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";var _api__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14);var _api__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_api__WEBPACK_IMPORTED_MODULE_0__);if(__webpack_require__.o(_api__WEBPACK_IMPORTED_MODULE_0__,"BASE_API_URL"))__webpack_require__.d(__webpack_exports__,"BASE_API_URL",(function(){return _api__WEBPACK_IMPORTED_MODULE_0__["BASE_API_URL"]}));if(__webpack_require__.o(_api__WEBPACK_IMPORTED_MODULE_0__,"LENS_EDIT_BY_VALUE"))__webpack_require__.d(__webpack_exports__,"LENS_EDIT_BY_VALUE",(function(){return _api__WEBPACK_IMPORTED_MODULE_0__["LENS_EDIT_BY_VALUE"]}));if(__webpack_require__.o(_api__WEBPACK_IMPORTED_MODULE_0__,"LENS_EMBEDDABLE_TYPE"))__webpack_require__.d(__webpack_exports__,"LENS_EMBEDDABLE_TYPE",(function(){return _api__WEBPACK_IMPORTED_MODULE_0__["LENS_EMBEDDABLE_TYPE"]}));if(__webpack_require__.o(_api__WEBPACK_IMPORTED_MODULE_0__,"NOT_INTERNATIONALIZED_PRODUCT_NAME"))__webpack_require__.d(__webpack_exports__,"NOT_INTERNATIONALIZED_PRODUCT_NAME",(function(){return _api__WEBPACK_IMPORTED_MODULE_0__["NOT_INTERNATIONALIZED_PRODUCT_NAME"]}));if(__webpack_require__.o(_api__WEBPACK_IMPORTED_MODULE_0__,"getBasePath"))__webpack_require__.d(__webpack_exports__,"getBasePath",(function(){return _api__WEBPACK_IMPORTED_MODULE_0__["getBasePath"]}));if(__webpack_require__.o(_api__WEBPACK_IMPORTED_MODULE_0__,"getEditPath"))__webpack_require__.d(__webpack_exports__,"getEditPath",(function(){return _api__WEBPACK_IMPORTED_MODULE_0__["getEditPath"]}));if(__webpack_require__.o(_api__WEBPACK_IMPORTED_MODULE_0__,"getFullPath"))__webpack_require__.d(__webpack_exports__,"getFullPath",(function(){return _api__WEBPACK_IMPORTED_MODULE_0__["getFullPath"]}));var _constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8);__webpack_require__.d(__webpack_exports__,"BASE_API_URL",(function(){return _constants__WEBPACK_IMPORTED_MODULE_1__["BASE_API_URL"]}));__webpack_require__.d(__webpack_exports__,"LENS_EDIT_BY_VALUE",(function(){return _constants__WEBPACK_IMPORTED_MODULE_1__["LENS_EDIT_BY_VALUE"]}));__webpack_require__.d(__webpack_exports__,"LENS_EMBEDDABLE_TYPE",(function(){return _constants__WEBPACK_IMPORTED_MODULE_1__["LENS_EMBEDDABLE_TYPE"]}));__webpack_require__.d(__webpack_exports__,"NOT_INTERNATIONALIZED_PRODUCT_NAME",(function(){return _constants__WEBPACK_IMPORTED_MODULE_1__["NOT_INTERNATIONALIZED_PRODUCT_NAME"]}));__webpack_require__.d(__webpack_exports__,"getBasePath",(function(){return _constants__WEBPACK_IMPORTED_MODULE_1__["getBasePath"]}));__webpack_require__.d(__webpack_exports__,"getEditPath",(function(){return _constants__WEBPACK_IMPORTED_MODULE_1__["getEditPath"]}));__webpack_require__.d(__webpack_exports__,"getFullPath",(function(){return _constants__WEBPACK_IMPORTED_MODULE_1__["getFullPath"]}));var _types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(15);var _types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_types__WEBPACK_IMPORTED_MODULE_2__)},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("entry/core/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"PLUGIN_ID",(function(){return PLUGIN_ID}));__webpack_require__.d(__webpack_exports__,"LENS_EMBEDDABLE_TYPE",(function(){return LENS_EMBEDDABLE_TYPE}));__webpack_require__.d(__webpack_exports__,"NOT_INTERNATIONALIZED_PRODUCT_NAME",(function(){return NOT_INTERNATIONALIZED_PRODUCT_NAME}));__webpack_require__.d(__webpack_exports__,"BASE_API_URL",(function(){return BASE_API_URL}));__webpack_require__.d(__webpack_exports__,"LENS_EDIT_BY_VALUE",(function(){return LENS_EDIT_BY_VALUE}));__webpack_require__.d(__webpack_exports__,"getBasePath",(function(){return getBasePath}));__webpack_require__.d(__webpack_exports__,"getEditPath",(function(){return getEditPath}));__webpack_require__.d(__webpack_exports__,"getFullPath",(function(){return getFullPath}));var PLUGIN_ID="lens";var LENS_EMBEDDABLE_TYPE="lens";var NOT_INTERNATIONALIZED_PRODUCT_NAME="Lens Visualizations";var BASE_API_URL="/api/lens";var LENS_EDIT_BY_VALUE="edit_by_value";function getBasePath(){return"#/"}function getEditPath(id){return id?"#/edit/".concat(encodeURIComponent(id)):"#/".concat(LENS_EDIT_BY_VALUE)}function getFullPath(id){return"/app/".concat(PLUGIN_ID).concat(id?getEditPath(id):getBasePath())}},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return setReportManager}));__webpack_require__.d(__webpack_exports__,"c",(function(){return stopReportManager}));__webpack_require__.d(__webpack_exports__,"e",(function(){return trackUiEvent}));__webpack_require__.d(__webpack_exports__,"d",(function(){return trackSuggestionEvent}));__webpack_require__.d(__webpack_exports__,"a",(function(){return factory_LensReportManager}));var external_kbnSharedDeps_Moment_=__webpack_require__(13);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);var common=__webpack_require__(2);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var STORAGE_KEY="lens-ui-telemetry";var reportManager;function setReportManager(newManager){if(reportManager){reportManager.stop()}reportManager=newManager}function stopReportManager(){if(reportManager){reportManager.stop()}}function trackUiEvent(name){if(reportManager){reportManager.trackEvent(name)}}function trackSuggestionEvent(name){if(reportManager){reportManager.trackSuggestionEvent(name)}}var factory_LensReportManager=function(){function LensReportManager(_ref){var _this=this;var storage=_ref.storage,http=_ref.http;_classCallCheck(this,LensReportManager);_defineProperty(this,"events",{});_defineProperty(this,"suggestionEvents",{});_defineProperty(this,"storage",void 0);_defineProperty(this,"http",void 0);_defineProperty(this,"timer",void 0);this.storage=storage;this.http=http;this.readFromStorage();this.timer=setInterval((function(){_this.postToServer()}),1e4)}_createClass(LensReportManager,[{key:"trackEvent",value:function trackEvent(name){this.readFromStorage();this.trackTo(this.events,name)}},{key:"trackSuggestionEvent",value:function trackSuggestionEvent(name){this.readFromStorage();this.trackTo(this.suggestionEvents,name)}},{key:"stop",value:function stop(){if(this.timer){clearInterval(this.timer)}}},{key:"readFromStorage",value:function readFromStorage(){var data=this.storage.get(STORAGE_KEY);if(data&&typeof data.events==="object"&&typeof data.suggestionEvents==="object"){this.events=data.events;this.suggestionEvents=data.suggestionEvents}}},{key:"postToServer",value:function(){var _postToServer=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.readFromStorage();if(!(Object.keys(this.events).length||Object.keys(this.suggestionEvents).length)){_context.next=12;break}_context.prev=2;_context.next=5;return this.http.post("".concat(common["BASE_API_URL"],"/stats"),{body:JSON.stringify({events:this.events,suggestionEvents:this.suggestionEvents})});case 5:this.events={};this.suggestionEvents={};this.write();_context.next=12;break;case 10:_context.prev=10;_context.t0=_context["catch"](2);case 12:case"end":return _context.stop()}}}),_callee,this,[[2,10]])})));function postToServer(){return _postToServer.apply(this,arguments)}return postToServer}()},{key:"trackTo",value:function trackTo(target,name){var date=external_kbnSharedDeps_Moment_default()().utc().format("YYYY-MM-DD");if(!target[date]){target[date]={[name]:1}}else if(!target[date][name]){target[date][name]=1}else{target[date][name]+=1}this.write()}},{key:"write",value:function write(){this.storage.set(STORAGE_KEY,{events:this.events,suggestionEvents:this.suggestionEvents})}}]);return LensReportManager}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return isDraggedOperation}));__webpack_require__.d(__webpack_exports__,"c",(function(){return isLensFilterEvent}));__webpack_require__.d(__webpack_exports__,"b",(function(){return isLensBrushEvent}));function isDraggedOperation(operationCandidate){return typeof operationCandidate==="object"&&operationCandidate!==null&&"columnId"in operationCandidate}function isLensFilterEvent(event){return event.name==="filter"}function isLensBrushEvent(event){return event.name==="brush"}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.Moment},function(module,exports){},function(module,exports){},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/savedObjects/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.MomentTimezone},function(module,exports,__webpack_require__){"use strict";module.exports=function(){function _min(d0,d1,d2,bx,ay){return d0<d1||d2<d1?d0>d2?d2+1:d0+1:bx===ay?d1:d1+1}return function(a,b){if(a===b){return 0}if(a.length>b.length){var tmp=a;a=b;b=tmp}var la=a.length;var lb=b.length;while(la>0&&a.charCodeAt(la-1)===b.charCodeAt(lb-1)){la--;lb--}var offset=0;while(offset<la&&a.charCodeAt(offset)===b.charCodeAt(offset)){offset++}la-=offset;lb-=offset;if(la===0||lb<3){return lb}var x=0;var y;var d0;var d1;var d2;var d3;var dd;var dy;var ay;var bx0;var bx1;var bx2;var bx3;var vector=[];for(y=0;y<la;y++){vector.push(y+1);vector.push(a.charCodeAt(offset+y))}var len=vector.length-1;for(;x<lb-3;){bx0=b.charCodeAt(offset+(d0=x));bx1=b.charCodeAt(offset+(d1=x+1));bx2=b.charCodeAt(offset+(d2=x+2));bx3=b.charCodeAt(offset+(d3=x+3));dd=x+=4;for(y=0;y<len;y+=2){dy=vector[y];ay=vector[y+1];d0=_min(dy,d0,d1,bx0,ay);d1=_min(d0,d1,d2,bx1,ay);d2=_min(d1,d2,d3,bx2,ay);dd=_min(d2,d3,dd,bx3,ay);vector[y]=dd;d3=d2;d2=d1;d1=d0;d0=dy}}for(;x<lb;){bx0=b.charCodeAt(offset+(d0=x));dd=++x;for(y=0;y<len;y+=2){dy=vector[y];vector[y]=dd=_min(dy,d0,dd,bx0,vector[y+1]);d0=dy}}return dd}}()},function(module,exports){module.exports=__kbnSharedDeps__.Rxjs},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_val_loader_dist_cjs_js_key_lens_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(21);var _node_modules_val_loader_dist_cjs_js_key_lens_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_val_loader_dist_cjs_js_key_lens_kbn_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__);__kbnBundles__.define("plugin/lens/public",__webpack_require__,22);__kbnBundles__.define("plugin/lens/common/constants",__webpack_require__,8)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__["lens"]},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"isDraggedOperation",(function(){return types["a"]}));__webpack_require__.d(__webpack_exports__,"isLensFilterEvent",(function(){return types["c"]}));__webpack_require__.d(__webpack_exports__,"isLensBrushEvent",(function(){return types["b"]}));__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var external_kbnSharedDeps_React_=__webpack_require__(6);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(7);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(9);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(0);var public_=__webpack_require__(5);var toAbsoluteDates=public_["search"].aggs.toAbsoluteDates;var mergeTables={name:"lens_merge_tables",type:"lens_multitable",help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.functions.mergeTables.help",{defaultMessage:"A helper to merge any number of kibana tables into a single table"}),args:{layerIds:{types:["string"],help:"",multi:true},tables:{types:["kibana_datatable"],help:"",multi:true}},inputTypes:["kibana_context","null"],fn(input,_ref){var layerIds=_ref.layerIds,tables=_ref.tables;var resultTables={};tables.forEach((function(table,index){resultTables[layerIds[index]]=table}));return{type:"lens_multitable",tables:resultTables,dateRange:getDateRange(input)}}};function getDateRange(value){if(!value||!value.timeRange){return}var dateRange=toAbsoluteDates(value.timeRange);if(!dateRange){return}return{fromDate:dateRange.from,toDate:dateRange.to}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var supportedFormats={number:{decimalsToPattern:function decimalsToPattern(){var decimals=arguments.length>0&&arguments[0]!==undefined?arguments[0]:2;if(decimals===0){return"0,0"}return"0,0.".concat("0".repeat(decimals))}},percent:{decimalsToPattern:function decimalsToPattern(){var decimals=arguments.length>0&&arguments[0]!==undefined?arguments[0]:2;if(decimals===0){return"0,0%"}return"0,0.".concat("0".repeat(decimals),"%")}},bytes:{decimalsToPattern:function decimalsToPattern(){var decimals=arguments.length>0&&arguments[0]!==undefined?arguments[0]:2;if(decimals===0){return"0,0b"}return"0,0.".concat("0".repeat(decimals),"b")}}};var formatColumn={name:"lens_format_column",type:"kibana_datatable",help:"",args:{format:{types:["string"],help:"",required:true},columnId:{types:["string"],help:"",required:true},decimals:{types:["number"],help:""}},inputTypes:["kibana_datatable"],fn(input,_ref){var format=_ref.format,columnId=_ref.columnId,decimals=_ref.decimals;return _objectSpread(_objectSpread({},input),{},{columns:input.columns.map((function(col){if(col.id===columnId){if(supportedFormats[format]){return _objectSpread(_objectSpread({},col),{},{formatHint:{id:format,params:{pattern:supportedFormats[format].decimalsToPattern(decimals)}}})}else{return _objectSpread(_objectSpread({},col),{},{formatHint:{id:format,params:{}}})}}return col}))})}};var persistence=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function embeddable_factory_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var embeddable_factory_EmbeddableFactory=function(){function EmbeddableFactory(getStartServices){var _this=this;_classCallCheck(this,EmbeddableFactory);this.getStartServices=getStartServices;embeddable_factory_defineProperty(this,"type",persistence["a"]);embeddable_factory_defineProperty(this,"savedObjectMetaData",{name:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.lensSavedObjectLabel",{defaultMessage:"Lens Visualization"}),type:persistence["a"],getIconForSavedObject:function getIconForSavedObject(){return"lensApp"}});embeddable_factory_defineProperty(this,"isEditable",_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$_this$getStart,capabilities;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.getStartServices();case 2:_yield$_this$getStart=_context.sent;capabilities=_yield$_this$getStart.capabilities;return _context.abrupt("return",capabilities.visualize.save);case 5:case"end":return _context.stop()}}}),_callee)}))));embeddable_factory_defineProperty(this,"createFromSavedObject",function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(savedObjectId,input,parent){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!input.savedObjectId){input.savedObjectId=savedObjectId}return _context2.abrupt("return",_this.create(input,parent));case 2:case"end":return _context2.stop()}}}),_callee2)})));return function(_x,_x2,_x3){return _ref2.apply(this,arguments)}}())}_createClass(EmbeddableFactory,[{key:"canCreateNew",value:function canCreateNew(){return false}},{key:"getDisplayName",value:function getDisplayName(){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.embeddableDisplayName",{defaultMessage:"lens"})}},{key:"create",value:function(){var _create=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(input,parent){var _yield$this$getStartS,timefilter,expressionRenderer,documentToExpression,uiActions,coreHttp,attributeService,indexPatternService,_yield$import,Embeddable;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this.getStartServices();case 2:_yield$this$getStartS=_context3.sent;timefilter=_yield$this$getStartS.timefilter;expressionRenderer=_yield$this$getStartS.expressionRenderer;documentToExpression=_yield$this$getStartS.documentToExpression;uiActions=_yield$this$getStartS.uiActions;coreHttp=_yield$this$getStartS.coreHttp;attributeService=_yield$this$getStartS.attributeService;indexPatternService=_yield$this$getStartS.indexPatternService;_context3.next=12;return Promise.all([__webpack_require__.e(1),__webpack_require__.e(0)]).then(__webpack_require__.bind(null,428));case 12:_yield$import=_context3.sent;Embeddable=_yield$import.Embeddable;_context3.t0=Embeddable;_context3.t1=attributeService;_context3.t2=indexPatternService;_context3.t3=timefilter;_context3.t4=expressionRenderer;_context3.next=21;return this.isEditable();case 21:_context3.t5=_context3.sent;_context3.t6=coreHttp.basePath;_context3.t7=uiActions===null||uiActions===void 0?void 0:uiActions.getTrigger;_context3.t8=documentToExpression;_context3.t9={attributeService:_context3.t1,indexPatternService:_context3.t2,timefilter:_context3.t3,expressionRenderer:_context3.t4,editable:_context3.t5,basePath:_context3.t6,getTrigger:_context3.t7,documentToExpression:_context3.t8};_context3.t10=input;_context3.t11=parent;return _context3.abrupt("return",new _context3.t0(_context3.t9,_context3.t10,_context3.t11));case 29:case"end":return _context3.stop()}}}),_callee3,this)})));function create(_x4,_x5){return _create.apply(this,arguments)}return create}()}]);return EmbeddableFactory}();function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function service_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function service_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function service_createClass(Constructor,protoProps,staticProps){if(protoProps)service_defineProperties(Constructor.prototype,protoProps);if(staticProps)service_defineProperties(Constructor,staticProps);return Constructor}function service_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function service_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function collectAsyncDefinitions(_x){return _collectAsyncDefinitions.apply(this,arguments)}function _collectAsyncDefinitions(){_collectAsyncDefinitions=service_asyncToGenerator(regeneratorRuntime.mark((function _callee5(definitions){var resolvedDefinitions,definitionMap;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return Promise.all(definitions.map((function(definition){return typeof definition==="function"?definition():definition})));case 2:resolvedDefinitions=_context5.sent;definitionMap={};resolvedDefinitions.forEach((function(definition){definitionMap[definition.id]=definition}));return _context5.abrupt("return",definitionMap);case 6:case"end":return _context5.stop()}}}),_callee5)})));return _collectAsyncDefinitions.apply(this,arguments)}var service_EditorFrameService=function(){function EditorFrameService(){service_classCallCheck(this,EditorFrameService);service_defineProperty(this,"datasources",[]);service_defineProperty(this,"visualizations",[])}service_createClass(EditorFrameService,[{key:"documentToExpression",value:function(){var _documentToExpression=service_asyncToGenerator(regeneratorRuntime.mark((function _callee(doc){var _yield$Promise$all,_yield$Promise$all2,resolvedDatasources,resolvedVisualizations,_yield$import,persistedStateToExpression;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([collectAsyncDefinitions(this.datasources),collectAsyncDefinitions(this.visualizations)]);case 2:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);resolvedDatasources=_yield$Promise$all2[0];resolvedVisualizations=_yield$Promise$all2[1];_context.next=8;return Promise.all([__webpack_require__.e(1),__webpack_require__.e(0)]).then(__webpack_require__.bind(null,428));case 8:_yield$import=_context.sent;persistedStateToExpression=_yield$import.persistedStateToExpression;_context.next=12;return persistedStateToExpression(resolvedDatasources,resolvedVisualizations,doc);case 12:return _context.abrupt("return",_context.sent);case 13:case"end":return _context.stop()}}}),_callee,this)})));function documentToExpression(_x2){return _documentToExpression.apply(this,arguments)}return documentToExpression}()},{key:"setup",value:function setup(core,plugins,getAttributeService){var _this=this;plugins.expressions.registerFunction((function(){return mergeTables}));plugins.expressions.registerFunction((function(){return formatColumn}));var getStartServices=function(){var _ref=service_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _yield$core$getStartS,_yield$core$getStartS2,coreStart,deps;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return core.getStartServices();case 2:_yield$core$getStartS=_context2.sent;_yield$core$getStartS2=_slicedToArray(_yield$core$getStartS,2);coreStart=_yield$core$getStartS2[0];deps=_yield$core$getStartS2[1];return _context2.abrupt("return",{attributeService:getAttributeService(),capabilities:coreStart.application.capabilities,coreHttp:coreStart.http,timefilter:deps.data.query.timefilter.timefilter,expressionRenderer:deps.expressions.ReactExpressionRenderer,documentToExpression:_this.documentToExpression.bind(_this),indexPatternService:deps.data.indexPatterns,uiActions:deps.uiActions});case 7:case"end":return _context2.stop()}}}),_callee2)})));return function getStartServices(){return _ref.apply(this,arguments)}}();if(plugins.embeddable){plugins.embeddable.registerEmbeddableFactory("lens",new embeddable_factory_EmbeddableFactory(getStartServices))}return{registerDatasource:function registerDatasource(datasource){_this.datasources.push(datasource)},registerVisualization:function registerVisualization(visualization){_this.visualizations.push(visualization)}}}},{key:"start",value:function start(core,plugins){var _this2=this;var createInstance=function(){var _ref2=service_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var domElement,_yield$Promise$all3,_yield$Promise$all4,resolvedDatasources,resolvedVisualizations;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return Promise.all([collectAsyncDefinitions(_this2.datasources),collectAsyncDefinitions(_this2.visualizations)]);case 2:_yield$Promise$all3=_context4.sent;_yield$Promise$all4=_slicedToArray(_yield$Promise$all3,2);resolvedDatasources=_yield$Promise$all4[0];resolvedVisualizations=_yield$Promise$all4[1];return _context4.abrupt("return",{mount:function(){var _mount=service_asyncToGenerator(regeneratorRuntime.mark((function _callee3(element,_ref3){var doc,onError,dateRange,query,filters,savedQuery,onChange,showNoDataPopover,initialContext,firstDatasourceId,firstVisualizationId,_yield$import2,EditorFrame,getActiveDatasourceIdFromDoc;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:doc=_ref3.doc,onError=_ref3.onError,dateRange=_ref3.dateRange,query=_ref3.query,filters=_ref3.filters,savedQuery=_ref3.savedQuery,onChange=_ref3.onChange,showNoDataPopover=_ref3.showNoDataPopover,initialContext=_ref3.initialContext;domElement=element;firstDatasourceId=Object.keys(resolvedDatasources)[0];firstVisualizationId=Object.keys(resolvedVisualizations)[0];_context3.next=6;return Promise.all([__webpack_require__.e(1),__webpack_require__.e(0)]).then(__webpack_require__.bind(null,428));case 6:_yield$import2=_context3.sent;EditorFrame=_yield$import2.EditorFrame;getActiveDatasourceIdFromDoc=_yield$import2.getActiveDatasourceIdFromDoc;Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["I18nProvider"],null,external_kbnSharedDeps_React_default.a.createElement(EditorFrame,{"data-test-subj":"lnsEditorFrame",onError:onError,datasourceMap:resolvedDatasources,visualizationMap:resolvedVisualizations,initialDatasourceId:getActiveDatasourceIdFromDoc(doc)||firstDatasourceId||null,initialVisualizationId:doc&&doc.visualizationType||firstVisualizationId||null,core:core,plugins:plugins,ExpressionRenderer:plugins.expressions.ReactExpressionRenderer,doc:doc,dateRange:dateRange,query:query,filters:filters,savedQuery:savedQuery,onChange:onChange,showNoDataPopover:showNoDataPopover,initialContext:initialContext})),domElement);case 10:case"end":return _context3.stop()}}}),_callee3)})));function mount(_x3,_x4){return _mount.apply(this,arguments)}return mount}(),unmount(){if(domElement){Object(external_kbnSharedDeps_ReactDom_["unmountComponentAtNode"])(domElement)}}});case 7:case"end":return _context4.stop()}}}),_callee4)})));return function createInstance(){return _ref2.apply(this,arguments)}}();return{createInstance:createInstance}}}]);return EditorFrameService}();var kibanaUtils_public_=__webpack_require__(12);function indexpattern_datasource_slicedToArray(arr,i){return indexpattern_datasource_arrayWithHoles(arr)||indexpattern_datasource_iterableToArrayLimit(arr,i)||indexpattern_datasource_unsupportedIterableToArray(arr,i)||indexpattern_datasource_nonIterableRest()}function indexpattern_datasource_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function indexpattern_datasource_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return indexpattern_datasource_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return indexpattern_datasource_arrayLikeToArray(o,minLen)}function indexpattern_datasource_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function indexpattern_datasource_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function indexpattern_datasource_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function indexpattern_datasource_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function indexpattern_datasource_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){indexpattern_datasource_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){indexpattern_datasource_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function indexpattern_datasource_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function indexpattern_datasource_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function indexpattern_datasource_createClass(Constructor,protoProps,staticProps){if(protoProps)indexpattern_datasource_defineProperties(Constructor.prototype,protoProps);if(staticProps)indexpattern_datasource_defineProperties(Constructor,staticProps);return Constructor}var indexpattern_datasource_IndexPatternDatasource=function(){function IndexPatternDatasource(){indexpattern_datasource_classCallCheck(this,IndexPatternDatasource)}indexpattern_datasource_createClass(IndexPatternDatasource,[{key:"setup",value:function setup(core,_ref){var expressions=_ref.expressions,editorFrame=_ref.editorFrame,charts=_ref.charts;editorFrame.registerDatasource(indexpattern_datasource_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$import,getIndexPatternDatasource,renameColumns;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([__webpack_require__.e(1),__webpack_require__.e(0)]).then(__webpack_require__.bind(null,428));case 2:_yield$import=_context.sent;getIndexPatternDatasource=_yield$import.getIndexPatternDatasource;renameColumns=_yield$import.renameColumns;expressions.registerFunction(renameColumns);return _context.abrupt("return",core.getStartServices().then((function(_ref3){var _ref4=indexpattern_datasource_slicedToArray(_ref3,2),coreStart=_ref4[0],data=_ref4[1].data;return getIndexPatternDatasource({core:coreStart,storage:new kibanaUtils_public_["Storage"](localStorage),data:data,charts:charts})})));case 7:case"end":return _context.stop()}}}),_callee)}))))}}]);return IndexPatternDatasource}();var external_kbnSharedDeps_MomentTimezone_=__webpack_require__(17);var external_kbnSharedDeps_MomentTimezone_default=__webpack_require__.n(external_kbnSharedDeps_MomentTimezone_);function xy_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function xy_visualization_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){xy_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){xy_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function xy_visualization_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function xy_visualization_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function xy_visualization_createClass(Constructor,protoProps,staticProps){if(protoProps)xy_visualization_defineProperties(Constructor.prototype,protoProps);if(staticProps)xy_visualization_defineProperties(Constructor,staticProps);return Constructor}function getTimeZone(uiSettings){var configuredTimeZone=uiSettings.get("dateFormat:tz");if(configuredTimeZone==="Browser"){return external_kbnSharedDeps_MomentTimezone_default.a.tz.guess()}return configuredTimeZone}var xy_visualization_XyVisualization=function(){function XyVisualization(){xy_visualization_classCallCheck(this,XyVisualization)}xy_visualization_createClass(XyVisualization,[{key:"setup",value:function setup(core,_ref){var expressions=_ref.expressions,formatFactory=_ref.formatFactory,editorFrame=_ref.editorFrame,charts=_ref.charts;editorFrame.registerVisualization(xy_visualization_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$import,legendConfig,yAxisConfig,tickLabelsConfig,gridlinesConfig,axisTitlesVisibilityConfig,layerConfig,xyChart,getXyChartRenderer,xyVisualization;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([__webpack_require__.e(1),__webpack_require__.e(0)]).then(__webpack_require__.bind(null,428));case 2:_yield$import=_context.sent;legendConfig=_yield$import.legendConfig;yAxisConfig=_yield$import.yAxisConfig;tickLabelsConfig=_yield$import.tickLabelsConfig;gridlinesConfig=_yield$import.gridlinesConfig;axisTitlesVisibilityConfig=_yield$import.axisTitlesVisibilityConfig;layerConfig=_yield$import.layerConfig;xyChart=_yield$import.xyChart;getXyChartRenderer=_yield$import.getXyChartRenderer;xyVisualization=_yield$import.xyVisualization;expressions.registerFunction((function(){return legendConfig}));expressions.registerFunction((function(){return yAxisConfig}));expressions.registerFunction((function(){return tickLabelsConfig}));expressions.registerFunction((function(){return gridlinesConfig}));expressions.registerFunction((function(){return axisTitlesVisibilityConfig}));expressions.registerFunction((function(){return layerConfig}));expressions.registerFunction((function(){return xyChart}));expressions.registerRenderer(getXyChartRenderer({formatFactory:formatFactory,chartsThemeService:charts.theme,timeZone:getTimeZone(core.uiSettings),histogramBarTarget:core.uiSettings.get(public_["UI_SETTINGS"].HISTOGRAM_BAR_TARGET)}));return _context.abrupt("return",xyVisualization);case 21:case"end":return _context.stop()}}}),_callee)}))))}}]);return XyVisualization}();function metric_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function metric_visualization_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){metric_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){metric_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function metric_visualization_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function metric_visualization_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function metric_visualization_createClass(Constructor,protoProps,staticProps){if(protoProps)metric_visualization_defineProperties(Constructor.prototype,protoProps);if(staticProps)metric_visualization_defineProperties(Constructor,staticProps);return Constructor}var MetricVisualization=function(){function MetricVisualization(){metric_visualization_classCallCheck(this,MetricVisualization)}metric_visualization_createClass(MetricVisualization,[{key:"setup",value:function setup(_core,_ref){var expressions=_ref.expressions,formatFactory=_ref.formatFactory,editorFrame=_ref.editorFrame;editorFrame.registerVisualization(metric_visualization_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$import,metricVisualization,metricChart,getMetricChartRenderer;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([__webpack_require__.e(1),__webpack_require__.e(0)]).then(__webpack_require__.bind(null,428));case 2:_yield$import=_context.sent;metricVisualization=_yield$import.metricVisualization;metricChart=_yield$import.metricChart;getMetricChartRenderer=_yield$import.getMetricChartRenderer;expressions.registerFunction((function(){return metricChart}));expressions.registerRenderer((function(){return getMetricChartRenderer(formatFactory)}));return _context.abrupt("return",metricVisualization);case 9:case"end":return _context.stop()}}}),_callee)}))))}}]);return MetricVisualization}();function datatable_visualization_slicedToArray(arr,i){return datatable_visualization_arrayWithHoles(arr)||datatable_visualization_iterableToArrayLimit(arr,i)||datatable_visualization_unsupportedIterableToArray(arr,i)||datatable_visualization_nonIterableRest()}function datatable_visualization_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function datatable_visualization_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return datatable_visualization_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return datatable_visualization_arrayLikeToArray(o,minLen)}function datatable_visualization_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function datatable_visualization_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function datatable_visualization_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function datatable_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function datatable_visualization_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){datatable_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){datatable_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function datatable_visualization_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function datatable_visualization_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function datatable_visualization_createClass(Constructor,protoProps,staticProps){if(protoProps)datatable_visualization_defineProperties(Constructor.prototype,protoProps);if(staticProps)datatable_visualization_defineProperties(Constructor,staticProps);return Constructor}var DatatableVisualization=function(){function DatatableVisualization(){datatable_visualization_classCallCheck(this,DatatableVisualization)}datatable_visualization_createClass(DatatableVisualization,[{key:"setup",value:function setup(core,_ref){var expressions=_ref.expressions,formatFactory=_ref.formatFactory,editorFrame=_ref.editorFrame;editorFrame.registerVisualization(datatable_visualization_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$import,datatable,datatableColumns,getDatatableRenderer,datatableVisualization;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([__webpack_require__.e(1),__webpack_require__.e(0)]).then(__webpack_require__.bind(null,428));case 2:_yield$import=_context.sent;datatable=_yield$import.datatable;datatableColumns=_yield$import.datatableColumns;getDatatableRenderer=_yield$import.getDatatableRenderer;datatableVisualization=_yield$import.datatableVisualization;expressions.registerFunction((function(){return datatableColumns}));expressions.registerFunction((function(){return datatable}));expressions.registerRenderer((function(){return getDatatableRenderer({formatFactory:formatFactory,getType:core.getStartServices().then((function(_ref3){var _ref4=datatable_visualization_slicedToArray(_ref3,2),_=_ref4[0],dataStart=_ref4[1].data;return dataStart.search.aggs.types.get}))})}));return _context.abrupt("return",datatableVisualization);case 11:case"end":return _context.stop()}}}),_callee)}))))}}]);return DatatableVisualization}();function pie_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function pie_visualization_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){pie_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){pie_visualization_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function pie_visualization_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function pie_visualization_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function pie_visualization_createClass(Constructor,protoProps,staticProps){if(protoProps)pie_visualization_defineProperties(Constructor.prototype,protoProps);if(staticProps)pie_visualization_defineProperties(Constructor,staticProps);return Constructor}var PieVisualization=function(){function PieVisualization(){pie_visualization_classCallCheck(this,PieVisualization)}pie_visualization_createClass(PieVisualization,[{key:"setup",value:function setup(core,_ref){var expressions=_ref.expressions,formatFactory=_ref.formatFactory,editorFrame=_ref.editorFrame,charts=_ref.charts;editorFrame.registerVisualization(pie_visualization_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$import,pieVisualization,pie,getPieRenderer;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([__webpack_require__.e(1),__webpack_require__.e(0)]).then(__webpack_require__.bind(null,428));case 2:_yield$import=_context.sent;pieVisualization=_yield$import.pieVisualization;pie=_yield$import.pie;getPieRenderer=_yield$import.getPieRenderer;expressions.registerFunction((function(){return pie}));expressions.registerRenderer(getPieRenderer({formatFactory:formatFactory,chartsThemeService:charts.theme}));return _context.abrupt("return",pieVisualization);case 9:case"end":return _context.stop()}}}),_callee)}))))}}]);return PieVisualization}();var lens_ui_telemetry=__webpack_require__(10);var core_public_=__webpack_require__(4);var uiActions_public_=__webpack_require__(3);var common=__webpack_require__(2);var vis_type_alias_getLensAliasConfig=function getLensAliasConfig(){return{aliasPath:Object(common["getBasePath"])(),aliasApp:"lens",name:"lens",promotion:{description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.visTypeAlias.promotion.description",{defaultMessage:"Try Lens, our new, intuitive way to create visualizations."}),buttonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.visTypeAlias.promotion.buttonText",{defaultMessage:"Go to Lens"})},title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.visTypeAlias.title",{defaultMessage:"Lens"}),description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.visTypeAlias.description",{defaultMessage:"Lens is a simpler way to create basic visualizations"}),icon:"lensApp",stage:"production",appExtensions:{visualizations:{docTypes:["lens"],searchFields:["title^3"],toListItem(savedObject){var id=savedObject.id,type=savedObject.type,attributes=savedObject.attributes;var _ref=attributes,title=_ref.title,description=_ref.description;return{id:id,title:title,description:description,editUrl:Object(common["getEditPath"])(id),editApp:"lens",icon:"lensApp",stage:"production",savedObjectType:type,typeTitle:external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.visTypeAlias.type",{defaultMessage:"Lens"})}}}}}};function visualize_field_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function visualize_field_actions_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){visualize_field_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){visualize_field_actions_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}var visualize_field_actions_visualizeFieldAction=function visualizeFieldAction(application){return Object(uiActions_public_["createAction"])({type:uiActions_public_["ACTION_VISUALIZE_LENS_FIELD"],id:uiActions_public_["ACTION_VISUALIZE_LENS_FIELD"],getDisplayName:function getDisplayName(){return external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.discover.visualizeFieldLegend",{defaultMessage:"Visualize field"})},isCompatible:function(){var _isCompatible=visualize_field_actions_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt("return",!!application.capabilities.visualize.show);case 1:case"end":return _context.stop()}}}),_callee)})));function isCompatible(){return _isCompatible.apply(this,arguments)}return isCompatible}(),execute:function(){var _execute=visualize_field_actions_asyncToGenerator(regeneratorRuntime.mark((function _callee2(context){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:application.navigateToApp("lens",{state:{type:uiActions_public_["ACTION_VISUALIZE_LENS_FIELD"],payload:context}});case 1:case"end":return _context2.stop()}}}),_callee2)})));function execute(_x){return _execute.apply(this,arguments)}return execute}()})};var js_levenshtein=__webpack_require__(18);var js_levenshtein_default=__webpack_require__.n(js_levenshtein);var external_kbnSharedDeps_Rxjs_=__webpack_require__(19);var search_provider_getSearchProvider=function getSearchProvider(uiCapabilities){return{id:"lens",find:function find(term){return Object(external_kbnSharedDeps_Rxjs_["from"])(uiCapabilities.then((function(_ref){var visualizeNavLink=_ref.navLinks.visualize;if(!visualizeNavLink){return[]}var title=external_kbnSharedDeps_KbnI18n_["i18n"].translate("xpack.lens.searchTitle",{defaultMessage:"Lens: create visualizations",description:"Lens is a product name and should not be translated"});var searchableTitle=title.toLowerCase();term=term.toLowerCase();var score=0;if(searchableTitle===term){score=100}else if(searchableTitle.startsWith(term)){score=90}else if(searchableTitle.includes(term)){score=75}else{var length=Math.max(term.length,searchableTitle.length);var distance=js_levenshtein_default()(term,searchableTitle);var ratio=Math.floor((1-distance/length)*100);if(ratio>=60){score=ratio}}if(score===0)return[];return[{id:"lens",title:title,type:"application",icon:"logoKibana",meta:{categoryId:core_public_["DEFAULT_APP_CATEGORIES"].kibana.id,categoryLabel:core_public_["DEFAULT_APP_CATEGORIES"].kibana.label},score:score,url:Object(common["getFullPath"])()}]})))}}};var savedObjects_public_=__webpack_require__(16);function lens_attribute_service_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function lens_attribute_service_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){lens_attribute_service_ownKeys(Object(source),true).forEach((function(key){lens_attribute_service_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{lens_attribute_service_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function lens_attribute_service_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function lens_attribute_service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function lens_attribute_service_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){lens_attribute_service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){lens_attribute_service_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function getLensAttributeService(core,startDependencies){var savedObjectStore=new persistence["b"](core.savedObjects.client);return startDependencies.dashboard.getAttributeService(persistence["a"],{saveMethod:function(){var _saveMethod=lens_attribute_service_asyncToGenerator(regeneratorRuntime.mark((function _callee(attributes,savedObjectId){var savedDoc;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return savedObjectStore.save(lens_attribute_service_objectSpread(lens_attribute_service_objectSpread({},attributes),{},{savedObjectId:savedObjectId,type:persistence["a"]}));case 2:savedDoc=_context.sent;return _context.abrupt("return",{id:savedDoc.savedObjectId});case 4:case"end":return _context.stop()}}}),_callee)})));function saveMethod(_x,_x2){return _saveMethod.apply(this,arguments)}return saveMethod}(),unwrapMethod:function(){var _unwrapMethod=lens_attribute_service_asyncToGenerator(regeneratorRuntime.mark((function _callee2(savedObjectId){var savedObject;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return core.savedObjects.client.get(persistence["a"],savedObjectId);case 2:savedObject=_context2.sent;return _context2.abrupt("return",lens_attribute_service_objectSpread(lens_attribute_service_objectSpread({},savedObject.attributes),{},{references:savedObject.references}));case 4:case"end":return _context2.stop()}}}),_callee2)})));function unwrapMethod(_x3){return _unwrapMethod.apply(this,arguments)}return unwrapMethod}(),checkForDuplicateTitle:function checkForDuplicateTitle(props){var savedObjectsClient=core.savedObjects.client;var overlays=core.overlays;return Object(savedObjects_public_["checkForDuplicateTitle"])({title:props.newTitle,copyOnSave:false,lastSavedTitle:"",getEsType:function getEsType(){return persistence["a"]},getDisplayName:function getDisplayName(){return persistence["a"]}},props.isTitleDuplicateConfirmed,props.onTitleDuplicate,{savedObjectsClient:savedObjectsClient,overlays:overlays})}})}function plugin_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function plugin_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){plugin_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){plugin_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function plugin_slicedToArray(arr,i){return plugin_arrayWithHoles(arr)||plugin_iterableToArrayLimit(arr,i)||plugin_unsupportedIterableToArray(arr,i)||plugin_nonIterableRest()}function plugin_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function plugin_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return plugin_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return plugin_arrayLikeToArray(o,minLen)}function plugin_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function plugin_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function plugin_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function plugin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function plugin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function plugin_createClass(Constructor,protoProps,staticProps){if(protoProps)plugin_defineProperties(Constructor.prototype,protoProps);if(staticProps)plugin_defineProperties(Constructor,staticProps);return Constructor}function plugin_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var plugin_LensPlugin=function(){function LensPlugin(){plugin_classCallCheck(this,LensPlugin);plugin_defineProperty(this,"datatableVisualization",void 0);plugin_defineProperty(this,"editorFrameService",void 0);plugin_defineProperty(this,"createEditorFrame",null);plugin_defineProperty(this,"attributeService",null);plugin_defineProperty(this,"indexpatternDatasource",void 0);plugin_defineProperty(this,"xyVisualization",void 0);plugin_defineProperty(this,"metricVisualization",void 0);plugin_defineProperty(this,"pieVisualization",void 0);this.datatableVisualization=new DatatableVisualization;this.editorFrameService=new service_EditorFrameService;this.indexpatternDatasource=new indexpattern_datasource_IndexPatternDatasource;this.xyVisualization=new xy_visualization_XyVisualization;this.metricVisualization=new MetricVisualization;this.pieVisualization=new PieVisualization}plugin_createClass(LensPlugin,[{key:"setup",value:function setup(core,_ref){var _this=this;var urlForwarding=_ref.urlForwarding,expressions=_ref.expressions,data=_ref.data,embeddable=_ref.embeddable,visualizations=_ref.visualizations,charts=_ref.charts,globalSearch=_ref.globalSearch;var editorFrameSetupInterface=this.editorFrameService.setup(core,{data:data,embeddable:embeddable,expressions:expressions},(function(){return _this.attributeService}));var dependencies={expressions:expressions,data:data,charts:charts,editorFrame:editorFrameSetupInterface,formatFactory:core.getStartServices().then((function(_ref2){var _ref3=plugin_slicedToArray(_ref2,2),_=_ref3[0],dataStart=_ref3[1].data;return dataStart.fieldFormats.deserialize}))};this.indexpatternDatasource.setup(core,dependencies);this.xyVisualization.setup(core,dependencies);this.datatableVisualization.setup(core,dependencies);this.metricVisualization.setup(core,dependencies);this.pieVisualization.setup(core,dependencies);visualizations.registerAlias(vis_type_alias_getLensAliasConfig());var getByValueFeatureFlag=function(){var _ref4=plugin_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _yield$core$getStartS,_yield$core$getStartS2,deps;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return core.getStartServices();case 2:_yield$core$getStartS=_context.sent;_yield$core$getStartS2=plugin_slicedToArray(_yield$core$getStartS,2);deps=_yield$core$getStartS2[1];return _context.abrupt("return",deps.dashboard.dashboardFeatureFlagConfig);case 6:case"end":return _context.stop()}}}),_callee)})));return function getByValueFeatureFlag(){return _ref4.apply(this,arguments)}}();core.application.register({id:"lens",title:common["NOT_INTERNATIONALIZED_PRODUCT_NAME"],navLinkStatus:core_public_["AppNavLinkStatus"].hidden,mount:function(){var _mount=plugin_asyncToGenerator(regeneratorRuntime.mark((function _callee2(params){var _yield$import,mountApp;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return Promise.all([__webpack_require__.e(1),__webpack_require__.e(0)]).then(__webpack_require__.bind(null,428));case 2:_yield$import=_context2.sent;mountApp=_yield$import.mountApp;return _context2.abrupt("return",mountApp(core,params,{createEditorFrame:_this.createEditorFrame,attributeService:_this.attributeService,getByValueFeatureFlag:getByValueFeatureFlag}));case 5:case"end":return _context2.stop()}}}),_callee2)})));function mount(_x){return _mount.apply(this,arguments)}return mount}()});if(globalSearch){globalSearch.registerResultProvider(search_provider_getSearchProvider(core.getStartServices().then((function(_ref5){var _ref6=plugin_slicedToArray(_ref5,1),capabilities=_ref6[0].application.capabilities;return capabilities}))))}urlForwarding.forwardApp("lens","lens")}},{key:"start",value:function start(core,startDependencies){this.attributeService=getLensAttributeService(core,startDependencies);this.createEditorFrame=this.editorFrameService.start(core,startDependencies).createInstance;if(startDependencies.uiActions.hasAction(uiActions_public_["ACTION_VISUALIZE_FIELD"])){startDependencies.uiActions.unregisterAction(uiActions_public_["ACTION_VISUALIZE_FIELD"])}startDependencies.uiActions.addTriggerAction(uiActions_public_["VISUALIZE_FIELD_TRIGGER"],visualize_field_actions_visualizeFieldAction(core.application))}},{key:"stop",value:function stop(){Object(lens_ui_telemetry["c"])()}}]);return LensPlugin}();var types=__webpack_require__(11);var public_plugin=function plugin(){return new plugin_LensPlugin}},function(module,exports){module.exports=__kbnSharedDeps__.TsLib},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,exports){module.exports=__kbnSharedDeps__.ElasticCharts},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/common");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/visualizations/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEuiLibServices},function(module,exports){module.exports=__kbnSharedDeps__.Theme.euiDarkVars},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.ReactRouterDom}]);